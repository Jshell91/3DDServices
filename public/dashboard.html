<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3DD Services Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ 3DD Services Dashboard</h1>
            <p>Panel de administraci√≥n y consultas</p>
            <button id="logout-btn" class="logout-btn">üö™ Logout</button>
        </header>

        <div class="dashboard">
            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>üëÅÔ∏è Total Visits</h3>
                    <div class="stat-number" id="totalPlayers">-</div>
                </div>
                <div class="stat-card">
                    <h3>‚ù§Ô∏è Total Likes</h3>
                    <div class="stat-number" id="totalLikes">-</div>
                </div>
                <div class="stat-card">
                    <h3>üó∫Ô∏è Maps Available</h3>
                    <div class="stat-number" id="totalMaps">-</div>
                </div>
                <div class="stat-card">
                    <h3>üåê Online Maps</h3>
                    <div class="stat-number" id="onlineMaps">-</div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-button active" data-tab="players">Players</button>
                <button class="tab-button" data-tab="likes">Artwork Likes</button>
                <button class="tab-button" data-tab="maps">Maps</button>
                <button class="tab-button" data-tab="online-maps">Online Maps</button>
                <button class="tab-button" data-tab="open-maps">Open Maps</button>
            </div>

            <!-- Content Sections -->
            <div class="tab-content">
                <!-- Players Tab -->
                <div id="players" class="tab-panel active">
                    <h2>Players by Level</h2>
                    <div class="table-container">
                        <table id="playersTable">
                            <thead>
                                <tr>
                                    <th>Level Name</th>
                                    <th>Player Count</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data loaded via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Likes Tab -->
                <div id="likes" class="tab-panel">
                    <h2>Artwork Likes</h2>
                    <div class="table-container">
                        <table id="likesTable">
                            <thead>
                                <tr>
                                    <th>Artwork ID</th>
                                    <th>Total Likes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data loaded via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Maps Tab -->
                <div id="maps" class="tab-panel">
                    <h2>üó∫Ô∏è Maps Management</h2>
                    <p>Use the Order input field to change the display order. Changes are saved automatically.</p>
                    
                    <!-- Add Map Button -->
                    <div style="margin-bottom: 20px;">
                        <button type="button" class="btn btn-primary" id="addMapBtn">
                            ‚ûï Add New Map
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table id="mapsTable">
                            <thead>
                                <tr>
                                    <th style="width: 70px;">Order</th>
                                    <th style="width: 180px;">Name</th>
                                    <th style="width: 200px;">Game Name</th>
                                    <th style="width: 150px;">Code Map</th>
                                    <th style="width: 80px;">Max Players</th>
                                    <th style="width: 100px;">Single Player</th>
                                    <th style="width: 70px;">Online</th>
                                    <th style="width: 70px;">Visible</th>
                                    <th style="width: 120px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="maps-tbody">
                                <!-- Data loaded via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Online Maps Tab -->
                <div id="online-maps" class="tab-panel">
                    <h2>Online Maps</h2>
                    <div class="table-container">
                        <table id="onlineMapsTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Map Name</th>
                                    <th>Address</th>
                                    <th>Port</th>
                                    <th>Players</th>
                                    <th>Status</th>
                                    <th>Opened</th>
                                    <th>Closed</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data loaded via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Open Maps Tab -->
                <div id="open-maps" class="tab-panel">
                    <h2>Open Maps Only</h2>
                    <div class="table-container">
                        <table id="openMapsTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Map Name</th>
                                    <th>Address</th>
                                    <th>Port</th>
                                    <th>Players</th>
                                    <th>Opened</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data loaded via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Refresh Button -->
            <div class="refresh-section">
                <button id="refresh-btn" class="refresh-btn">üîÑ Refresh Data</button>
            </div>
        </div>
    </div>

    <!-- Edit Map Modal -->
    <div id="editMapModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Map</h3>
                <span class="close" id="closeModal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editMapForm">
                    <input type="hidden" id="mapId" name="mapId">
                    
                    <div class="form-group">
                        <label for="mapDisplayOrder">Display Order</label>
                        <input type="number" id="mapDisplayOrder" name="display_order" min="1" value="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="mapName">Map Name *</label>
                        <input type="text" id="mapName" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapValue">Map Value *</label>
                        <input type="text" id="mapValue" name="map" required>
                        <small>Usually the same as Map Name</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapGameName">Game Name *</label>
                        <input type="text" id="mapGameName" name="name_in_game" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapCodeMap">Code Map</label>
                        <input type="text" id="mapCodeMap" name="codemap">
                    </div>
                    
                    <div class="form-group">
                        <label for="mapMaxPlayers">Max Players *</label>
                        <input type="number" id="mapMaxPlayers" name="max_players" min="1" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapSinglePlayer">Single Player</label>
                        <select id="mapSinglePlayer" name="is_single_player">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapOnline">Online</label>
                        <select id="mapOnline" name="is_online">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapVisible">Visible in Map Select</label>
                        <select id="mapVisible" name="visible_map_select">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="mapViews">Views</label>
                        <input type="number" id="mapViews" name="views" min="0" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="mapSponsor">Sponsor</label>
                        <input type="text" id="mapSponsor" name="sponsor">
                    </div>
                    
                    <div class="form-group">
                        <label for="mapImage">Image URL</label>
                        <input type="url" id="mapImage" name="image">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelEdit">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveMapChanges">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Edit Display Order Modal -->
    <div id="editOrderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚úèÔ∏è Edit Display Order</h3>
                <span class="close" onclick="closeEditOrderModal()">&times;</span>
            </div>
            <div id="order-modal-body">
                <p><strong>Map:</strong> <span id="modal-map-name"></span></p>
                <p><strong>Current Order:</strong> <span id="modal-current-order"></span></p>
                <label for="new-order">New Order:</label>
                <input type="number" id="new-order" class="display-order-input" min="1" style="width: 100px; margin-left: 10px;">
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn btn-secondary" onclick="closeEditOrderModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="saveOrder()">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add New Map Modal -->
    <div id="addMapModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ûï Add New Map</h3>
                <span class="close" id="closeAddMapModal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addMapForm">
                    <div class="form-group">
                        <label for="newMapDisplayOrder">Display Order <span class="required">*</span></label>
                        <input type="number" id="newMapDisplayOrder" name="display_order" min="1" required>
                        <small>Order in which this map appears in the list</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapName">Name <span class="required">*</span></label>
                        <input type="text" id="newMapName" name="name" required>
                        <small>Display name of the map</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapGameName">Game Name <span class="required">*</span></label>
                        <input type="text" id="newMapGameName" name="name_in_game" required>
                        <small>Name as shown in-game</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapCodeMap">Code Map</label>
                        <input type="text" id="newMapCodeMap" name="codemap">
                        <small>Optional code identifier</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapMaxPlayers">Max Players <span class="required">*</span></label>
                        <input type="number" id="newMapMaxPlayers" name="max_players" min="1" value="4" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapSinglePlayer">Single Player</label>
                        <select id="newMapSinglePlayer" name="is_single_player">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapOnline">Online</label>
                        <select id="newMapOnline" name="is_online">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapVisible">Visible in Map Select</label>
                        <select id="newMapVisible" name="visible_map_select">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapViews">Views</label>
                        <input type="number" id="newMapViews" name="views" min="0" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapSponsor">Sponsor</label>
                        <input type="text" id="newMapSponsor" name="sponsor">
                    </div>
                    
                    <div class="form-group">
                        <label for="newMapImage">Image URL</label>
                        <input type="url" id="newMapImage" name="image">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelAddMap">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveNewMap">Create Map</button>
            </div>
        </div>
    </div>

    <!-- Load SortableJS from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>
